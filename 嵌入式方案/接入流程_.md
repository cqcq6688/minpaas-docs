#  接入流程
  
  
##  一、平台第一次接入流程
  
用于SaaS平台第一次接入小程序PaaS，主要步骤如下：
![第一次接入流程](第一次接入流程.png )
  
##  二、接入流程说明
  
###  0 开通账号
  
请联系小程序PaaS平台PO开通“开发者控制台”账户。
  
###  1 初始化应用
  
在SaaS系统接入前，需要在小程序PaaS初始化一个应用。
必须的步骤为：“登录账户”->“创建应用"->"发布应用"。
可选的步骤为：“配置资源和环境”、“引用资源和设置环境”，用于资源私有化、引用业务组件和匹配SaaS研发环境。
如下图所示：
![app](app.png )
  
具体步骤如下：
  
####  1.1登录账户
  
使用小程序PaaS提供的账号密码进行登录开发者控制台（https://minapp.mypaas.com.cn）：
![login](login.png )
####  1.2 配置资源和环境
  
用于SaaS接入的私有化配置、研发环境配置和注册组件资源（如果使用平台默认配置，可以跳过该步）。
#####  1.2.1 配置管理
  
######  1.2.1.1 部署配置
  
入口为：[配置管理-部署配置](https://minapp.mypaas.com.cn/resource/deployment-config/list )。
用于自定义部署和版本相关的产物，典型的内容如：运行时元数据
![meta1](meta1.png )
![meta2](meta2.png )
######  1.2.1.2 文件存储配置
  
入口为：[配置管理-文件存储配置](https://minapp.mypaas.com.cn/resource/deployment-file/list )。
用于自定义存储和版本无关的文件，典型的内容如：图片
![doc-data1](doc-data1.png )
![doc-data2](doc-data2.png )
#####  1.2.2 创建/编辑业务环境
  
1、 业务环境对应SaaS研发流程，如SaaS系统有“开发”->“测试”->“预发布”->“生产”几个环境，则可在创建对应的环境，用于提供不同环境所需的配置项。
2、 部署配置和文件存储配置默认采用平台提供的公有云配置，有私有化需求则要提前在【资源管理-配置管理】中进行添加配置
![env1](env1.png )
![env2](env2.png )
  
#####  1.2.3 注册组件包
  
用于注册SaaS团队开发的自定义组件，目前提供以组件包的方式进行注册（如果没有业务组件注册，可跳过该步骤）。
注意：注册组件包前需要联系小程序PaaS平台，以开通PaaS平台对该组件仓库的读取权限。
![component1](component1.png )
![component2](component2.png )
#####  1.2.3.1 编辑组件详情
  
组件包内的组件可进行组件详情的编辑，用于设计器内的组件展示和
  
####  1.3 创建应用
  
如下图所示，进行应用的创建
![app-1](app-1.png )
![app0](app0.png )
  
####  1.4 引用资源和设置环境
  
创建完应用，可设置应用当前的业务环境和引用的组件资源（如果使用平台默认配置，可以跳过该步）。
#####  1.4.1 引用组件
  
![app1](app1.png )
![app2](app2.png )
  
#####  1.4.2 设置业务环境
  
![app3](app3.png )
  
####  1.5 发布应用版本
  
1）点击应用，进入开发者设计器，可进行应用的发布（目前开发者设计器还在完善中，仅提供应用发布功能）：
![design1](design1.png )
2）点击发布，出现发布界面
![design2](design2.png )
3）填入版本号，点击新建版本
![design3](design3.png )
4）完成版本创建即可进行发布
![design5](design5.png )
![design6](design6.png )
5）点击确认，回到设计器，点击“退出”，回到【应用管理-工作区】
![design7](design7.png )
6）如下图所示，完成了一个版本的发布（发布到了指定的环境），并自动设置为“线上版本”，SaaS创建租户应用时会以该版本为准进行创建：
![design8](design8.png )
  
  
###  2 平台对接准备
  
平台对接需要准备以下内容：
|序号|名称|内容|说明|
|--|--|--|--|
|1|团队秘钥|appId、appSecret|用于openApi对接鉴权，小程序PaaS平台自动生成|
|2|应用编码|appCode|SaaS团队开发的小程序应用编码，创建应用时填入|
|3|环境编码|envCode|待对接小程序的环境编码，创建业务环境时填入|
|4|租户编码|tenentCode|租户编码，SaaS平台传入|
|5|租户应用编码|tenentAPPCode|租户应用编码，SaaS平台传入|
####  2.1 获取团队秘钥
  
入口：[团队管理-团队秘钥](https://minapp.mypaas.com.cn/team/secret )
![team](team.png )
####  2.2 获取应用编码
  
入口：应用管理-工作区管理-应用配置-基本信息
![appcode](appcode.png )
####  2.3 获取环境编码
  
![envcode0](envcode0.png )
![envcode](envcode.png )
####  2.4 对接openApi
  
对接流程（AI云店数据迁移方案）：
1）云店适配方案:[《对接天际平台小程序PaaS》](https://shimo.im/docs/CwHXggrRxV9wXdxg/ )
2）数据迁移方案:![数据迁移方案](数据迁移方案.png )
3）接口文档：[openApi接口文档](../平台应用API/README.md )
  
###  3 开通租户
  
  
  